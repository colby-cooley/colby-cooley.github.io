---
title: "Movie Genre"
description: |
  Investigation into whether or not a movie's genre affects its IMDb rating
author: Colby Cooley
date: October 27, 2025
format: html
execute: 
  warning: false
  message: false
---

Movie ratings are widely used to evaluate films. People often claim that some genres are “better” than others based on audience scores. However, this perception might just be random variation. Understanding whether genre truly influences ratings could help studios and critics separate taste patterns from statistical noise. By examining a dataset of movies and their ratings, we can statistically test whether observed differences in ratings across genres are likely to occur by chance. A permutation test is perfect for this because it will simply test whether the association between genre and rating is stronger than we would expect if genres had no effect.

```{r}
library(tidyverse)
```

The following dataset contains information on the genre and rating 10,000 different movies in the IMDb database. We are specifically interested in these variables because we want to observe the relationship between them.

```{r}
imdb <- read_csv(
  "data/imdb-movies-dataset.csv"
) |>
  mutate(Genre2 = str_extract(Genre, "^[A-z-]+")) |>
  select(Title, Genre2, Rating) 
```

The following plot shows the differences in the distributions of different genre's movie ratings based on this data. You can see how some genres have higher ratings than others and vice versa.

```{r}
ggplot(imdb, aes(x = Genre2, y = Rating, fill = Genre2)) +
  geom_boxplot() +
  labs(title = "Rating Distribution of Movies in Different Genres", x = "Genre", fill = "Genre") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Our research question will have the following hypotheses:
- Null Hypothesis(Ho): Movie ratings are independent of genre. Any observed differences in average ratings across genres are due to random chance.
- Alternative Hypothesis(Ha): Movie ratings differ by genre; some genres consistently receive higher or lower ratings.

Our observed statistic, which measures how much genre-specific averages deviate from the overall mean rating based on the data, is as follows:

```{r}
imdb |> summarize(avg_rating = mean(Rating, na.rm = TRUE))
mean_rating <- 6.43861
imdb |>
  group_by(Genre2) |>
  summarize(ni = n(), xi = mean(Rating, na.rm = TRUE)) |>
  summarize(stat = sum(ni * (xi - mean_rating)^2, na.rm = TRUE))
obs_stat <- 1085.533
```

Now we need a function that can simulate/permute this calculation while assuming genres are randomly assigned to movies(the null hypothesis(Ho)). In other words, each simulation randomly reassigns genres to movies to break any real association between genre and rating.

```{r}
imdb_sim <- function(x) {
  sim_value <- imdb |>
    mutate(Genre2 = sample(Genre2, n(), replace = FALSE)) |>
    group_by(Genre2) |>
    summarize(ni = n(), xi = mean(Rating, na.rm = TRUE)) |>
    summarize(stat = sum(ni * (xi - mean_rating)^2, na.rm = TRUE)) |>
    pull(stat)
  return(sim_value)
}
```

Then we can use mapping to run this simulation/permutation many times so that we can be more confident in the results.

```{r}
set.seed(47)
null_stats <- map_dbl(c(1:1000), ~imdb_sim(.x))
```

The following plot shows the distribution of the one-thousand simulated/permuted values as well as a vertical line at the observed statistic.

```{r}
null_df <- data.frame(stat = null_stats)

ggplot(null_df, aes(x = stat)) +
  geom_histogram(binwidth = 1, color = "black") +
  geom_vline(xintercept = obs_stat, color = "red", linetype = "dashed", size = 1.2) +
  annotate("text", x = obs_stat, y = 50, label = "Observed Statistic", 
           color = "red", angle = 90, vjust = -0.5, hjust = 1.2) +
  labs(
    title = "Null Distribution of Permuted Statistics",
    x = "Simulated Statistic",
    y = "Frequency"
  ) +
  theme_minimal()
```

As you can see, not a single one of the thousand permuted statistics even came close to being at least as extreme as the observed statistic, meaning the p-value for this test is 0. This means that we have very strong evidence supporting the alternative hypthesis(Ha) that movie ratings differ by genre and that some genres consistently receive higher or lower ratings.

References:
Barthwal, Aman. *IMDb Movies Data*. Kaggle, 2024.  
[https://www.kaggle.com/datasets/amanbarthwal/imdb-movies-data](https://www.kaggle.com/datasets/amanbarthwal/imdb-movies-data)